format short g 
n = 5

n =

     5

A = randn(n)

A =

      0.53767      -1.3077      -1.3499     -0.20497       0.6715
       1.8339     -0.43359       3.0349     -0.12414      -1.2075
      -2.2588      0.34262       0.7254       1.4897      0.71724
      0.86217       3.5784    -0.063055        1.409       1.6302
      0.31877       2.7694      0.71474       1.4172      0.48889

[V,D] = eig(A)

V =

    -0.041875 +    0.24264i    -0.041875 -    0.24264i     0.092319 +          0i       0.6296 +          0i     -0.26676 +          0i
       0.6411 +          0i       0.6411 +          0i    -0.079624 +          0i     -0.18102 +          0i      0.17398 +          0i
     -0.23008 +    0.31599i     -0.23008 -    0.31599i     -0.28792 +          0i     -0.41147 +          0i      0.61487 +          0i
     -0.39477 -    0.33304i     -0.39477 +    0.33304i       0.6904 +          0i      0.60249 +          0i      0.52134 +          0i
     -0.21396 -    0.25107i     -0.21396 +    0.25107i     -0.65238 +          0i      0.19629 +          0i      0.49872 +          0i


D =

      -1.1631 +     2.7273i            0 +          0i            0 +          0i            0 +          0i            0 +          0i
            0 +          0i      -1.1631 -     2.7273i            0 +          0i            0 +          0i            0 +          0i
            0 +          0i            0 +          0i     -0.40254 +          0i            0 +          0i            0 +          0i
            0 +          0i            0 +          0i            0 +          0i        1.809 +          0i            0 +          0i
            0 +          0i            0 +          0i            0 +          0i            0 +          0i       3.6472 +          0i

d = diag(D)

d =

      -1.1631 +     2.7273i
      -1.1631 -     2.7273i
     -0.40254 +          0i
        1.809 +          0i
       3.6472 +          0i

values = d(abs(imag(d))<1e-14)

values =

     -0.40254
        1.809
       3.6472

vectors = V(:,abs(imag(d))<1e-14)

vectors =

     0.092319       0.6296     -0.26676
    -0.079624     -0.18102      0.17398
     -0.28792     -0.41147      0.61487
       0.6904      0.60249      0.52134
     -0.65238      0.19629      0.49872

lambda = values(1)

lambda =

     -0.40254

v = vectors(:,1)

v =

     0.092319
    -0.079624
     -0.28792
       0.6904
     -0.65238


b = rand(n,1)

b =

      0.75774
      0.74313
      0.39223
      0.65548
      0.17119

I = eye(n);
w = (A-lambda*I)\b
[Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  7.395347e-17.] 
[] 

w =

   1.8133e+13
  -1.5639e+13
   -5.655e+13
    1.356e+14
  -1.2813e+14

uw = w/norm(w)

uw =

     0.092319
    -0.079624
     -0.28792
       0.6904
     -0.65238


p = rand(n,1)

p =

      0.70605
     0.031833
      0.27692
     0.046171
     0.097132

C = (A-lambda*I)+b*p'

C =

       1.4752      -1.2836      -1.1401     -0.16998       0.7451
       2.3586   -0.0073942       3.2407    -0.089833      -1.1353
      -1.9819      0.35511       1.2366       1.5078      0.75534
        1.325       3.5993      0.11846       1.8418       1.6939
      0.43963       2.7749      0.76215       1.4251      0.90806

xi = C\b

xi =

      -1.9006
       1.6392
       5.9274
      -14.213
       13.431

wd = xi/(1-p'*xi)

wd =

   1.9149e+13
  -1.6516e+13
   -5.972e+13
    1.432e+14
  -1.3532e+14

uwd = wd/norm(wd)

uwd =

     0.092319
    -0.079624
     -0.28792
       0.6904
     -0.65238


disp("Difference of direction")
Difference of direction
Dd = norm(uwd-uw)

Dd =

   2.8339e-16

disp("Difference of magnitude")
Difference of magnitude
Dm = abs((norm(uw)-norm(wd)))

Dm =

   2.0742e+14

diary
